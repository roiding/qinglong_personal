# E5 管理脚本配置示例
# 使用前请将此文件复制为 .env 或在青龙面板中设置环境变量

# ============================================================
# 共用配置（所有脚本都需要）
# ============================================================

# Azure AD 租户 ID (在 Azure Portal > Azure Active Directory > 概述 中查看)
E5_TENANT_ID=your-tenant-id-here

# 应用程序客户端 ID
E5_CLIENT_ID=your-client-id-here

# 客户端密钥 (在 Azure Portal > 应用注册 > 证书和密码 中生成)
# 用于 OneDrive 监控和用户有效期检查脚本
E5_CLIENT_SECRET=your-client-secret-here

# 用户前缀筛选（可选，默认为 "Salted Fish"）
# 脚本会筛选所有显示名称或邮箱以此前缀开头的用户
E5_USER_PREFIX=Salted Fish

# ============================================================
# e5_onedrive_monitor.py - OneDrive 使用情况监控
# ============================================================
# 每周运行一次，查询用户 OneDrive 使用情况并推送报告
# Cron: 0 9 * * 1

# 需要的应用权限（Application）：
# - User.Read.All
# - Files.Read.All
# - Sites.Read.All

# ============================================================
# e5_user_expiration.py - 用户有效期检查
# ============================================================
# 每天运行一次，检查用户有效期，自动禁用/删除过期用户
# Cron: 0 9 * * *

# 提前警告天数（可选，默认 15 天）
# 距离过期小于此天数时，自动禁用用户
E5_WARNING_DAYS=15

# 用户有效期设置方式：
# - 在 Azure AD 中，将用户的 postalCode 字段设置为有效期年数
# - 例如：postalCode=2 表示有效期 2 年
# - 如果 postalCode 为空或不是数字，默认为 1 年

# 需要的应用权限（Application）：
# - User.Read.All
# - User.ReadWrite.All（用于禁用/删除用户）

# ============================================================
# e5_keep_active.py - API 活跃保持
# ============================================================
# 每天 8:00-22:00，每 10 分钟运行一次，保持账号活跃
# Cron: */10 8-22 * * *

# 要保持活跃的账号用户名（邮箱）
E5_KEEPER_USERNAME=user@yourdomain.onmicrosoft.com

# 该账号的密码
E5_KEEPER_PASSWORD=your-password-here

# 注意：此脚本使用委托权限（Delegated），只访问登录用户自己的数据
# 需要在 Azure AD 应用注册中：
# 1. 启用"允许公共客户端流"（身份验证 > 高级设置）
# 2. 添加以下委托权限（Delegated）：
#    - Mail.Read
#    - Tasks.Read
#    - Calendars.Read
# 3. 授予管理员同意

# ============================================================
# 推送配置（可选）
# ============================================================

# Bark 推送 API 地址
NOTIFY_API=https://your-bark-server.com/your-device-key

# ============================================================
# Azure AD 应用配置说明
# ============================================================

# 1. 创建应用注册
#    - 访问 Azure Portal: https://portal.azure.com
#    - Azure Active Directory > 应用注册 > 新注册
#    - 记录 租户 ID 和 客户端 ID

# 2. 生成客户端密钥
#    - 应用注册 > 证书和密码 > 新客户端密码
#    - 设置过期时间（建议 24 个月）
#    - 复制生成的密钥值（只显示一次！）

# 3. 配置 API 权限
#    A. 应用权限（Application permissions）- 用于 OneDrive 监控和用户管理
#       - 应用注册 > API 权限 > 添加权限 > Microsoft Graph > 应用权限
#       - 添加：User.Read.All, User.ReadWrite.All, Files.Read.All, Sites.Read.All
#       - 点击"授予管理员同意"
#
#    B. 委托权限（Delegated permissions）- 用于活跃保持
#       - 应用注册 > API 权限 > 添加权限 > Microsoft Graph > 委托权限
#       - 添加：Mail.Read, Tasks.Read, Calendars.Read
#       - 点击"授予管理员同意"

# 4. 启用 ROPC 流程（用于活跃保持脚本）
#    - 应用注册 > 身份验证
#    - 滚动到底部"高级设置"
#    - "允许公共客户端流" 设为 "是"

# ============================================================
# 安全建议
# ============================================================
# - 定期轮换 CLIENT_SECRET 和密码
# - 不要在公开仓库中提交 .env 文件
# - 青龙面板中设置环境变量时，确保只有管理员可见
# ============================================================
